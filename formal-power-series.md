---
marp: true
math: mathjax
---


# 形式的冪級数勉強会

### 2025/10/25

Harui (Twitter: @Nutoriaezu88808, GitHub: @Harui-i)

---
# 許して
私は代数をよく知らないこと、体系的にFPSを学んだことがないことから、間違いや不適切な表現があるかもしれません。もしあれば、教えていただけると幸いです。

---
# FPSとは？

数列 $(a_i)_{i=0}^{\infty}$ に対して、$\sum_{i=0}^{\infty} a_i x^i$ と書くものを通常型母関数(Ordinary Generating Function, **OGF**)といいます。

$\sum_{i=0}^{\infty} a_i \frac{x^i}{i!}$ と書くものを指数型母関数(Exponential Generating Function, **EGF**)といいます。

このように、数列に対応する冪級数を考えている、ということを意識することが重要な気がしています。

---
## 例

- 数列 $(3, 1, 4, 1, 5, 9)$に対応するOGFは $3 + 1x + 4x^2 + 1x^3 + 5x^4 + 9x^5$

- 数列 $(3, 1, 4, 1, 5, 9)$に対応するEGFは $3 + 1\frac{x}{1!} + 4\frac{x^2}{2!} + 1\frac{x^3}{3!} + 5\frac{x^4}{4!} + 9\frac{x^5}{5!} = 3 + x + 2x^2 + \frac{x^3}{3!} + \frac{x^4}{4!} + \frac{x^5}{5!}$

---
## いろいろな言葉について

- FPS(Formal Power Series) = 形式的冪級数
- OGF(Ordinary Generating Function) = 通常型母関数
- EGF(Exponential Generating Function) = 指数型母関数

---
# 形式的冪級数の演算や性質

ここでは、数列のことは一旦忘れて、FPSの演算や性質について扱います。　なので、数列→FPSの対応付けの違いであるOGF/EGFの違いは一旦忘れても大丈夫です。

FPSの和/差/積/微分/積分は、通常の多項式と同じように定義されます。

## 和/差/積
$f = \sum_{i=0}^{\infty} a_i x^i, g = \sum_{i=0}^{\infty} b_i x^i$ としたとき、

$$ f+g = \sum_{i=0}^{\infty} (a_i + b_i) x^i $$

$$ fg = \sum_{i=0}^{\infty} \left( \sum_{j=0}^{i} a_j b_{i-j} \right) x^i $$

---
## 微分

極限を考えているわけではなく、こういう操作に微分という名前をつけているだけです。

$$ f' = \sum_{i=1}^{\infty} i a_i x^{i-1} $$

---
## 逆元
ここからはおそらく新しい演算に見えると思います。
係数は $\mathbb{Q}$ や $\mathbb{F}_{998244353}$ のような体上であるとします。

$f = \sum_{i=0}^{\infty} a_i x^i$ に対して、$g = \sum_{i=0}^{\infty} b_i x^i$ を $fg = 1$ (この右辺の $1$ は $(1, 0, 0, \ldots)$ に対応するFPS) を満たすような $g$を、$f$ の逆元と呼びます。

$f$の逆元は、$a_0 \neq 0$なら一意に存在して、そうでないと存在しません。(証明略)(逆元を手計算で計算する方法をしれば、この条件は納得できると思います)

---
### 逆元の計算方法・例

$f = 1 - x$ の逆元 $g = \sum_{i=0}^{\infty} b_i x^i$ を求めます。

$fg = 1$ と、 $fg = (1-x)g = g - xg = \sum_{i=0}^{\infty} b_i x^i - \sum_{i=0}^{\infty} b_i x^{i+1} = b_0 + \sum_{i=1}^{\infty} (b_i - b_{i-1}) x^i$ から、$b_0 = 1, \space b_i = b_{i-1} (i \geq 1)$

がわかるので、$g = \sum_{i=0}^{\infty} 1 x^i = 1 + x + x^2 + x^3 + \ldots$ となります。

つまり、

$$ 1 = (1-x)(1 + x + x^2 + x^3 + \ldots )$$

こういう意味で、
$$ \frac{1}{1-x} = 1 + x + x^2 + x^3 + \ldots $$

と書いている気がします(要出展)

---
### 逆元の手計算

$1-x$の逆元が$1 + x + x^2 + \ldots$であるのは知っている思いますが、$1 - \frac{x^2}{6} + \frac{x^4}{120}$ の逆元を手計算で求めるとき、上のようにシグマ計算するのは大変なので、筆算のやり方を知っていると(手で計算したいときに)便利です。
(スライドで筆算を説明するのは面倒なので、画像を挿入するか、実演する)


<!-- ↓ここを最後のスライドとしたい-->
---
# 参考文献

- https://codeforces.com/blog/entry/77468
  - OGF/EGFの定義からいろいろな性質まで扱っている(英語)
- https://trap.jp/post/1657/
    - traPのFPSの講習会の資料らしい。計算方法や、問題を手計算で解く方法などが詳しく書かれている。

- https://maspypy.com/多項式・形式的べき級数数え上げとの対応付け
    - FPSで数え上げ問題を解く方法について。 (2)や(3)も参考になる。